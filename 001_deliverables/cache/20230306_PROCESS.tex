% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \setmainfont[]{Bahnschrift:style=Bold}
  \setmonofont[]{Bahnschrift:style=Condensed}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Processing data sources for analysis},
  pdfauthor={Michael-Philipp Stiebing},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Processing data sources for analysis}
\author{Michael-Philipp Stiebing}
\date{2023-03-10}

\begin{document}
\maketitle

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Start by importing libraries
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(lubridate)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(readr)}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Read the csv files of the Divvy data into separate dataframes
\item
  Combine all dataframes into a single dataframe
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"/home/mikiR/remote\_transfer/"}\NormalTok{)}
\NormalTok{X202110\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202110{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202111\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202111{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202112\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202112{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202201\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202201{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202202\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202202{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202203\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202203{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202204\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202204{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202205\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202205{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202206\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202206{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202207\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202207{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202208\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202208{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202209\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202209{-}divvy{-}tripdata.csv"}\NormalTok{)}
\NormalTok{X202210\_divvy\_tripdata }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/202210{-}divvy{-}tripdata.csv"}\NormalTok{)}

\NormalTok{all\_trips }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(}
\NormalTok{                  X202110\_divvy\_tripdata, X202111\_divvy\_tripdata, X202112\_divvy\_tripdata, X202201\_divvy\_tripdata,}
\NormalTok{                  X202202\_divvy\_tripdata, X202203\_divvy\_tripdata, X202204\_divvy\_tripdata, X202205\_divvy\_tripdata,}
\NormalTok{                  X202206\_divvy\_tripdata, X202207\_divvy\_tripdata, X202208\_divvy\_tripdata, X202209\_divvy\_tripdata, }
\NormalTok{                  X202210\_divvy\_tripdata)}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Create new columns from date field, split into

  \begin{itemize}
  \tightlist
  \item
    month
  \item
    day
  \item
    year
  \item
    day of week
  \item
    time of day
  \item
    hour
  \end{itemize}
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{started\_at)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{month }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{date), }\StringTok{"\%m"}\NormalTok{)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{day }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{date), }\StringTok{"\%d"}\NormalTok{)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{year }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{date), }\StringTok{"\%Y"}\NormalTok{)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{day\_of\_week }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{date), }\StringTok{"\%A"}\NormalTok{)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{timeofday }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(}\FunctionTok{as.POSIXct}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{started\_at), }\AttributeTok{format =} \StringTok{"\%H:\%M:\%S"}\NormalTok{)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{hours }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(}\FunctionTok{as.POSIXct}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{started\_at), }\AttributeTok{format =} \StringTok{"\%H"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Create column ridelength calculated from the difference of ended\_at
  and started\_at
\item
  Convert column value into numeric
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{ride\_length }\OtherTok{\textless{}{-}} \FunctionTok{difftime}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{ended\_at,all\_trips}\SpecialCharTok{$}\NormalTok{started\_at)}
\NormalTok{all\_trips}\SpecialCharTok{$}\NormalTok{ride\_length }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{ride\_length))}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Remove bad data
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips\_v2 }\OtherTok{\textless{}{-}}\NormalTok{ all\_trips[}\SpecialCharTok{!}\NormalTok{(all\_trips}\SpecialCharTok{$}\NormalTok{ride\_length}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Move bad data into a dataframe to doublecheck
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips\_errors }\OtherTok{\textless{}{-}}\NormalTok{ all\_trips[(all\_trips}\SpecialCharTok{$}\NormalTok{ride\_length}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Read the climate data into a dataframe
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"/home/mikiR/remote\_transfer/"}\NormalTok{)}
\NormalTok{climate\_chicago\_202110\_202210 }\OtherTok{\textless{}{-}} 
  \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./20221205{-}capstone\_datascience{-}01/002\_data/001\_csv/climate\_chicago\_202110{-}202210.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Convert the date field in the climate data frame to date format
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{climate\_chicago\_202110\_202210}\SpecialCharTok{$}\NormalTok{date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(climate\_chicago\_202110\_202210}\SpecialCharTok{$}\NormalTok{date)}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Trying to calculate the distance between gps coordinates start\_lng \&
  start\_lat / end\_lng \& end\_lat
\item
  Import geosphere library
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(geosphere) }
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Calculate the distance between the start and end coordinates using the
  Haversine formula
\item
  Create new column geodist with the calculated distance
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips\_v3 }\OtherTok{\textless{}{-}}\NormalTok{ all\_trips\_v2 }\SpecialCharTok{\%\textgreater{}\%} 
              \FunctionTok{mutate}\NormalTok{(}\AttributeTok{geodist =} \FunctionTok{distHaversine}\NormalTok{(}
                    \FunctionTok{cbind}\NormalTok{(all\_trips\_v2}\SpecialCharTok{$}\NormalTok{start\_lng,all\_trips\_v2}\SpecialCharTok{$}\NormalTok{start\_lat), }
                    \FunctionTok{cbind}\NormalTok{(all\_trips\_v2}\SpecialCharTok{$}\NormalTok{end\_lng,all\_trips\_v2}\SpecialCharTok{$}\NormalTok{end\_lat)))}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Filter all trips with distance = 0 into a dataframe called
  round\_trips, the assumtion being that when the trip ends where it
  started
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{round\_trips }\OtherTok{=} \FunctionTok{filter}\NormalTok{(all\_trips\_v3,geodist }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\item
  While working with the data, I noticed some very long rental periods (
  \textgreater{} 86400 seconds, aka one day) I think this would be
  maintenance work, as this would be unlikely to be a rental from a
  customer
\item
  Also, I filtered out all rentals under 1 minute, since these do not
  represent useful customer behavior as well
\item
  Similarly, all entries that have a geodist value of NA - because they
  don't have a return station value, are similarly out for maintenance,
  or stolen, or in case of very short rental periods of a few seconds,
  maybe a booking error or system test
\item
  I filtered these sets into dataframes into short\_ride long\_ride and
  nadist\_ride in order to analyze a little bit
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{short\_ride }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{filter}\NormalTok{(all\_trips\_v3,ride\_length }\SpecialCharTok{\textless{}} \DecValTok{60} \SpecialCharTok{\&} \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(geodist)))}
\NormalTok{long\_ride }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{filter}\NormalTok{(all\_trips\_v3,ride\_length }\SpecialCharTok{\textgreater{}} \DecValTok{86400} \SpecialCharTok{\&} \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(geodist)))}
\NormalTok{nadist\_ride }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{filter}\NormalTok{(all\_trips\_v3,}\FunctionTok{is.na}\NormalTok{(geodist)))}

\FunctionTok{summary}\NormalTok{(}\FunctionTok{filter}\NormalTok{(long\_ride)}\SpecialCharTok{$}\NormalTok{ride\_length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   86445   89809   97212  222552  207746 2442301
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{filter}\NormalTok{(nadist\_ride)}\SpecialCharTok{$}\NormalTok{ride\_length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##       6   89990   89994  175632   90001 2483235
\end{verbatim}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Create a new dataframe all\_trips\_v4 containing only trips under
  86400 s \& geodist not NA
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips\_v4 }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{filter}\NormalTok{(all\_trips\_v3,ride\_length }\SpecialCharTok{\textless{}} \DecValTok{86400} \SpecialCharTok{\&}\NormalTok{ ride\_length }\SpecialCharTok{\textgreater{}} \DecValTok{60} \SpecialCharTok{\&}\NormalTok{ ride\_length }\SpecialCharTok{!=} \DecValTok{0} \SpecialCharTok{\&} \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(geodist)))}
\FunctionTok{summary}\NormalTok{(}\FunctionTok{filter}\NormalTok{(all\_trips\_v4)}\SpecialCharTok{$}\NormalTok{ride\_length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    61.0   366.0   634.0   998.6  1129.0 86391.0
\end{verbatim}

\fontsize{10}{12}
\selectfont

\begin{itemize}
\tightlist
\item
  Another oddity I found in the data was rides with very high speeds,
  when dividing geodist in meters by ridelength in seconds
\item
  I created a new column speed with the calculated value geodist /
  ride\_length, and filter out all rides with speed above 10 m/s (36
  km/h or 22.4 mph) - pedal assisted bikes are capped at 20 mph
\item
  If the value is very low, this can mean a leisurely ride, or a ride
  that ends close to where it began, whereas a high value can only mean
  transport by other means, and since rented bikes are not allowed on
  CTA (\url{https://www.transitchicago.com/bikeandride/}) this can only
  mean the bike was not being used by a customer
\item
  looking at the distribution of values, the bulk of non round trips
  seems to be around the average biking speed, the mean of the speed
  column being at 2.9 m/s - 6.5 mph
\end{itemize}

\fontsize{9}{11}
\selectfont

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_trips\_v5 }\OtherTok{\textless{}{-}}\NormalTok{ all\_trips\_v4 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{speed =}\NormalTok{ geodist }\SpecialCharTok{/}\NormalTok{ ride\_length) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(speed }\SpecialCharTok{\textless{}} \DecValTok{10}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(all\_trips\_v5}\SpecialCharTok{$}\NormalTok{speed)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   2.059   2.957   2.897   3.822  10.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(all\_trips\_v5}\SpecialCharTok{$}\NormalTok{speed)}
\end{Highlighting}
\end{Shaded}

\includegraphics{20230306_PROCESS_files/figure-latex/unnamed-chunk-12-1.pdf}
\fontsize{10}{12} \selectfont

\begin{itemize}
\tightlist
\item
  I decided to create a new dataframe, all\_trips\_v5, filtering out the
  entries with impausibly high speed
\end{itemize}

\end{document}
